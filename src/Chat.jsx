import React, { useState, useEffect, useRef } from 'react';const Chat = () => {  const [messages, setMessages] = useState([]);  const [input, setInput] = useState('');  const messagesEndRef = useRef(null);  const scrollToBottom = () => {    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });  };  useEffect(() => {    scrollToBottom();  }, [messages]);  const handleSend = async () => {    if (input.trim()) {      const newMessages = [...messages, { role: 'user', content: input }];      setMessages(newMessages);      setInput('');      const response = await fetch('/api/chat', {        method: 'POST',        headers: {          'Content-Type': 'application/json',        },        body: JSON.stringify({ messages: newMessages }),      });      const reader = response.body.getReader();      const decoder = new TextDecoder();      let fullResponse = '';      while (true) {        const { value, done } = await reader.read();        if (done) break;        const chunk = decoder.decode(value);        const jsonMatch = chunk.match(/data: (.*)\n\n/);        if (jsonMatch && jsonMatch[1] !== '[DONE]') {          try {            const data = JSON.parse(jsonMatch[1]);            if (data.choices && data.choices[0].delta.content) {              fullResponse += data.choices[0].delta.content;            }          } catch (e) {            console.error("Error parsing SSE chunk", e);          }        }      }            setMessages(prevMessages => [...prevMessages, { role: 'assistant', content: fullResponse }]);    }  };  return (    <div className="chat-container">      <div className="messages">        {messages.map((msg, index) => (          <div key={index} className={`message ${msg.role}`}>            {msg.content}          </div>        ))}        <div ref={messagesEndRef} />      </div>      <div className="input-area">        <textarea          value={input}          onChange={(e) => setInput(e.target.value)}          onKeyDown={(e) => {            if (e.key === 'Enter' && !e.shiftKey) {              e.preventDefault();              handleSend();            }          }}          placeholder="Type your message..."        />        <button onClick={handleSend}>Send</button>      </div>    </div>  );};export default Chat;